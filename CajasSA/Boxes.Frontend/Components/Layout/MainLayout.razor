@inherits LayoutComponentBase
@using MudBlazor

<MudThemeProvider Theme="@_theme" IsDarkMode="_isDarkMode" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1" Color="Color.Primary">
        <MudIconButton Icon="@Icons.Material.Filled.Menu"
                       Color="Color.Inherit" Edge="Edge.Start"
                       OnClick="@((e) => DrawerToggle())" />
        <MudText Typo="Typo.h5" Class="ml-3">Proveedores</MudText>
        <MudSpacer />
        <MudIconButton Icon="@(DarkLightModeButtonIcon)"
                       Color="Color.Inherit"
                       OnClick="@DarkModeToggle" />
        <MudIconButton Icon="@Icons.Material.Filled.MoreVert"
                       Color="Color.Inherit" Edge="Edge.End" />
    </MudAppBar>

    <MudDrawer id="nav-drawer" @bind-Open="_drawerOpen"
               ClipMode="DrawerClipMode.Always" Elevation="2">
        <NavMenu />
    </MudDrawer>

    <MudMainContent Class="pt-16 pa-4">
        @Body
    </MudMainContent>
</MudLayout>

<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>

@code {
    private bool _drawerOpen = true;
    private bool _isDarkMode = false; // inicia claro
    private MudTheme? _theme = null;

    protected override void OnInitialized()
    {
        _theme = new()
        {
            PaletteLight = _lightPalette,
            PaletteDark = _darkPalette,
            LayoutProperties = new LayoutProperties()
            {
                DefaultBorderRadius = "10px"
            }
        };
    }

    private void DrawerToggle() => _drawerOpen = !_drawerOpen;

    private void DarkModeToggle() => _isDarkMode = !_isDarkMode;

    // -------- Paleta "cartonera" (CLARO) --------
    private readonly PaletteLight _lightPalette = new()
    {
        // Colores de marca
        Primary = "#6D4C41", // marrón
        Secondary = "#B58B68", // caramelo
        Tertiary = "#D6CBBE", // beige arena

        // Fondos
        Background = "#FFFCF6", // casi blanco cálido
        Surface = "#F3EEE6", // kraft claro
        DrawerBackground = "#F3EEE6",
        DrawerText = "#3E2723",

        // AppBar
        AppbarBackground = "#5D4037",
        AppbarText = "#FFFFFF",

        // Texto / líneas
        TextPrimary = "#3E2723",
        TextSecondary = "#5D4037",
        Divider = "#E2D8CA",
        TableLines = "#E9E2D8",

        // Estados
        Success = "#6BAA75",
        Warning = "#E0A106",
        Error = "#C44230",
        Info = "#7C9CBF",
    };

    // -------- Paleta "cartonera" (OSCURO) --------
    private readonly PaletteDark _darkPalette = new()
    {
        // Colores de marca
        Primary = "#B58B68", // caramelo
        Secondary = "#D6CBBE", // beige arena
        Tertiary = "#F3EEE6", // kraft claro

        // Fondos
        Background = "#3E2723",
        Surface = "#5D4037",
        DrawerBackground = "#5D4037",
        DrawerText = "#F5F0E6",

        // AppBar
        AppbarBackground = "#3E2723",
        AppbarText = "#F5F0E6",

        // Texto / líneas
        TextPrimary = "#F5F0E6",
        TextSecondary = "#E6DCCF",
        Divider = "#5A463D",
        TableLines = "#5A463D",

        // Estados
        Success = "#8FCF9B",
        Warning = "#F3C34F",
        Error = "#E57368",
        Info = "#9CB6D6",
    };

    public string DarkLightModeButtonIcon => _isDarkMode
        ? Icons.Material.Rounded.AutoMode
        : Icons.Material.Outlined.DarkMode;
}